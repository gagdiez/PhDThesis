\section{An\'alisis del m\'etodo Moreno-Dominguez}

Moreno-Dominguez et al. \cite{Moreno-Dominguez2014} implementan el algoritmo
\textit{Agglomerative Hierarchical Clustering} para agrupar los tractogramas. 
En particular utilizan como medida de similitud la distancia coseno 
(Ecuaci\'on \ref{eq:cosine}) y como criterio de \textit{linkage} el centroide 
(Ecuaci\'on \ref{eq:centroide}).\\

Utilizar \textit{Hierarchical Agglomerative Clustering} con la distancia 
coseno y el \textit{linkage} centroide presenta algunas desventajas. 
Primero, la distancia coseno no distingue distancias entre clusters colineales.
Segundo, el promedio de probabilidades no necesariamente representa una
probabilidad \cite{Pohl2007}. Esto quiere decir que el centroide de un grupo 
de tractogramas no necesariamente representa el promedio de estos tractogramas.
Finalmente la distancia coseno obliga a tener que comparar expl\'icitamente 
cada centroide con los clusters existentes. Notemos que esto implica mantener
los clusters en memoria. A continuaci\'on detallamos cada una de estas  
desventajas. \\

\subsection{Clustering de vectores colineales}

La distancia coseno es una forma de medir co\-rrelaci\'on entre vectores. Por 
ello, cuando lo que se intenta agrupar son vectores colineales el resultado es
aleatorio. Por ejemplo, cuando se aplica el procedimiento sobre los puntos de 
la Figura \ref{fig:3clusters} el resultado del clustering es la Figura 
\ref{fig:3moreno}. Usando LogOdds y la m\'etrica euclidiana se consigue el
\textit{clustering} de la Figura \ref{fig:3logit}. \\

\begin{figure}[h!]
        \centering
        \includegraphics[width=0.5\textwidth]{img/3pop.png}
        \caption{Tres clusters colineales\-}
        \label{fig:3clusters}
\end{figure}

Por la forma que posee el algoritmo \ref{alg:itract}, los tractogramas creados 
poseen muchos voxels lejanos con valores peque\~nos. Esto surge de simular el 
recorrido de las part\'iculas de agua sobre los mapas de transiciones.
Los voxels cercanos a la semilla tendran intrinsecamente mayor probabilidad 
de ser visitados. Para llegar a un voxel lejano es necesario realizar mayor 
cantidad de transiciones. Cuanto mas lejos un voxel menor probabilidad tiene
de ser visitado. La Figura \ref{fig:hist_tract} muestra el histograma de los 
valores en los tractogramas del \'Area de Broca. Esta gran cantidad de voxels
con valores tan bajos podr\'ia generar ruido en las correlaciones.  

\begin{figure}[h!]

\centering                                                                                                          
\begin{minipage}[b]{0.85\textwidth}
    \includegraphics[width=\textwidth]{img/3pop_moreno.png}
    \caption{Clustering resultado de utilizar el m\'etodo Moreno}
    \label{fig:3moreno}
\end{minipage} ~

\end{figure}  

\begin{figure}[h!]
              \centering                                                                                                          
\begin{minipage}[b]{0.8\textwidth}
    \includegraphics[width=\textwidth]{img/hist_tract.png}
    \caption{Histograma normalizado de los valores en los tractogramas del
             \'Area de Broca}
    \label{fig:hist_tract}
\end{minipage} ~

\end{figure}  


\subsection{Relaci\'on m\'etrica-\textit{linkage}}

La Figura \ref{fig:cos_cen} muestra 4 vectores aleatorios $p_i = (X_i, Y_i)$.
Las variables $X_i$ e $Y_i$ independientes y provienen de una distribuci\'on
Bernulli. Las posiciones en coordenadas polares de cada vector son:
$ p_1 = (0.4, 45^\circ)$; $p_2 = (0.3, 25^\circ)$;  $p_3 = (0.4, 66^\circ)$ y
$p_4 = (0.4, 4.5^\circ)$. \\

Podemos apreciar que al principio $d(p_2,p_3) < d(p_3,p_4) < d(p_1,p_2)$, siendo
$d(x,y)$ la distancia coseno (Ecuaci\'on \ref{eq:cosine}). Sin embargo, luego 
de utilizar el \textit{linkage centroid} (Ecuaci\'on \ref{eq:centroide}) sucede
que $d(p_1,p_c) < d(p_4,p_c)$. $p_4$ es ahora el punto que mas lejos est\'a del
centroide. Creando un representante $p_m$ usando el \'angulo medio entre $p_2$
y $p_3$ esto no sucede. Este fen\'omeno se da porque la distancia coseno tiene
en cuenta el \'angulo pero el centroide no. Por lo tanto el centroide no 
caracteriza al punto medio respecto a la distancia coseno. \\

\begin{figure}[h!]
                                                                                                                        
\begin{minipage}[b]{\textwidth}
    \includegraphics[width=\textwidth]{img/cosine_centroid.png}
    \caption{El centroide no representa el punto medio respecto al \'angulo}
    \label{fig:cos_cen}
\end{minipage} ~

\end{figure}  

\subsection{Complejidad algor\'itmica del clustering}

El diagrama de la figura \ref{fig:diagrama} divide el proceso de parcelaci\'on
de la corteza en varios pasos: seleccionar los voxels que ser\'an utilizados 
como semilla de cada tractograma; luego generar cada tractograma y finalmente
agruparlos usando alg\'un algoritmo de clustering. En todo este proceso el paso
mas caro en t\'erminos computacionales es el \textit{clustering}. Veamos la 
complejidad del m\'etodo propuesto por Moreno-Dominguez. En cada iteraci\'on 
del algoritmo es necesario comparar expl\'icitamente cada nuevo centroide con
todo el resto de los clusters. Esto es costoso computacionalmente. Por cada
iteraci\'on es necesario hacer $O(c^2 m)$ operaciones para recalcular todas las
distancias, donde $c$ es la cantidad de clusters y $m$ es la longitud de los
mismos. Dadas $n$ semillas iniciales, la cantidad de iteraciones a realizar son
$n-1$. La complejidad de este m\'etodo es $O(n^3 m)$. \\ 

Podemos ver que el utilizar \textit{Hierarchical Agglomerative Clustering} 
con la distancia coseno y el \textit{linkage} centroide presenta algunas
desventajas. La m\'etrica no pareciera ser compatible con la medida de
similitud; es necesario mantener todos los tractogramas en memoria y no 
permite agrupar de manera correcta clusters colineales. \\

