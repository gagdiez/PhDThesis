\chapter{Introducci\'on}

En la neurociencia moderna existe la teor\'ia de que el cerebro
puede ser dividido en \'areas de acuerdo a distintos criterios estructurales,
siendo la citoarquitectura de Broadmann \cite{Brodmann1909} una de la m\'as conocidas.
Actualmente existe evidencia de que es posible atribuir un criterio funcional
a cada una de estas regiones, como mover la mano o procesar el lenguaje
\cite{Greicius2003}. No obstante, el c\'omo se relacionan dichas \'areas con acciones
complejas sigue siendo un problema abierto \cite{Barch2013}. As\'i mismo, tampoco
se conoce si esta divisi\'on es \'unica, y en tal caso, qu\'e l\'imites definen
a cada \'area. La relaci\'on funci\'on-estructura posee diversas aplicaciones en la
medicina, como por ejemplo el planeamiento quir\'urgico \cite{Stufflebeam2011}
\cite{Oishi2010}; asistencia durante la cirug\'ia \cite{Bello2008} y rehabilitaci\'on
\cite{Song2014} de pacientes. Por ello existe la necesidad de entender c\'omo es
que el cerebro est\'a conectado estructuralmente, esto es, entender qu\'e regiones
est\'an conectadas f\'isicamente por axones y cu\'anto influye esto en el aspecto
funcional del cerebro. \\

El cerebro puede dividirse en dos tipos de tejido: materia blanca y materia gris.
La corteza est\'a formada por materia gris, la cual es densa en neuronas, mientras
que la materia blanca est\'a compuesta por axones que las conectan entre si \cite{Dale2008}.
El reciente desarrollo de la Resonancia Magn\'etica de Difusi\'on (dMRI) permiti\'o
desarrollar nuevas t\'ecnicas para estudiar la conectividad estructural \cite{Taylor1985}. 
En particular, el conocer la intensidad de difusi\'on que existe en cada punto del 
cerebro permite caracterizar los axones dentro de la materia blanca \cite{Hagmann2006}.
Una forma de hacerlo es utilizando algoritmos de tractograf\'ia \cite{Descoteaux2009}
\cite{Jbabdi2007}, estos toman un punto del cerebro como semilla y devuelven un
tractograma. Un tractograma es una imagen donde cada voxel representa la
probabilidad de que ese punto del cerebro est\'e conectado a la semilla elegida
mediante un conjunto de axones. 
Las probabilidades se estiman mediante un procedimiento Monte Carlo, simulando el
recorrido de un n\'umero de part\'iculas de agua por la materia blanca comenzando
desde dicha semilla. Como cada neurona posee
asociado un ax\'on, colocar semillas en la interfaz entre la materia gris y la
blanca permite caracterizar las regiones de la corteza \cite{Mori2002}
\cite{Anwander2006}. Distintos grupos han propuesto el agrupar estas semillas
empleando un algoritmo de clustering para definir nuevos criterios de parcelamiento
de la corteza cerebral. \\

\vspace{0.3cm}

Los algoritmos de clustering son una herramienta de an\'alisis en campos como
\textit{Machine Learning} y \textit{Data Mining}. Permiten agrupar objetos
en base a alg\'un criterio de similitud. Ejemplos de ellos son: 

\begin{itemize}
    \item K-means: Divide $n$ vectores en $k$ clusters diferentes, siendo $k$
                   un n\'umero predefinido. Cada cluster est\'a formado 
                   por los elementos que m\'as cerca est\'an al vector medio del
                   mismo. \cite{Hartigan1979}
    \item Agglomerative Hierarchical Clustering: Cada observaci\'on comienza en 
                   un cluster distinto. Luego, el algoritmo selecciona iterativamente
                   dos clusters siguiendo alg\'un criterio de similitud, los agrupa
                   en un nuevo cluster y crea un elemento representativo de este.
                   La jerarqu\'ia resultante de agrupar todos los clusters
                   es expresada como un dendrograma. \cite{Mining2009}
    \item Gaussian Mixture: Asume que todas las observaciones provienen de un 
                   n\'umero finito de distribuciones Gaussianas con par\'ametros
                   desconocidos. Implementa \textit{expectation-maximization} para
                   determinar dichos par\'ametros iterativamente. \cite{Mining2009}
\end{itemize}

Cada algoritmo utiliza distintos modelos de cluster, por lo que el espacio de
aplicaci\'on y el resultado de cada uno var\'ia significativamente. \\

El primer paso a realizar para parcelar la corteza utilizando clustering
de semillas es generar los tractogramas. 
Seleccionar los voxels que ser\'an semilla requiere contar con alguna manera de
discriminar entre materia blanca y materia gris en la imagen. A su vez, si se
desea que las semillas est\'en a cierta distancia de la corteza, se debe tener
cuidado en respetar la forma del cerebro. En la literatura actual se
utilizan hasta veinte mil semillas por hemisferio \cite{Moreno-Dominguez2014} y
cien mil part\'iculas por semilla \cite{Anwander2006} para generar los tractogramas.
Realizar cada uno en paralelo es una forma de optimizar el tiempo que toma
su creaci\'on. Al momento de representarlos es importante seleccionar la estructura
correcta. Una matriz del tama\~no de la dMRI es la implementaci\'on mas sencilla, 
pero solo el 30\% (ver Secci\'on X) de los valores ser\'an no nulos. Luego, para
agrupar los tractogramas se debe seleccionar un algoritmo, una m\'etrica y 
un tipo de \textit{linkage}. Dependiendo la representaci\'on elegida deber\'a
adaptarse el algoritmo para obtener una mejor eficacia. Finalmente, una vez
obtenidos los clusters, es necesario mapear cada semilla con su respectivo voxel
en la corteza cerebral. En resumen, primero hay que situar las semillas en la
materia blanca. Luego se deben generar los tractogramas de estas. Finalmente se
debe aplicar el algoritmo de clustering. Todos estos pasos son caros en terminos
computacionales y brindan distintos resultados dependiendo de las decisiones que
se tomen. \\

Distintos grupos han aplicado diferentes criterios en cada uno de los pasos
nombrados para parcelar la corteza. Por ejemplo, Behrens et. al \cite{Behrens2003}
utilizan \textit{Target-Based Clustering}, este algoritmo define como
restricci\'on que cada \'area solo puede estar conectada con alguna otra
perteneciente a un conjunto predefinido. Anwander et. al \cite{Anwander2006} 
parcelan el \'Area de Broca utilizando \textit{k-means}, para lo cual se necesita
definir un n\'umero de parcelas a encontrar. Moreno-Dominguez et al. 
\cite{Moreno-Dominguez2014} sit\'uan semillas en la interfaz entre materia blanca
y materia gris, a partir de las cuales se crean tractogramas. Dichos tractogramas
son luego agrupados utilizando el algoritmo \textit{Agglomerative Hierarchical
Clustering} con la distancia coseno como medida de similitud, y un centroide como
representante de cada Cluster. La gran ventaja de este \'ultimo caso es que la
parcelaci\'on resultante no posee restricciones respecto al n\'umero de parcelas
a generar, o sobre como las mismas deber\'ian estar conectadas. Por el contrario,
dependiendo la forma en que se desee cortar el dendrograma se obtendr\'an
distintos grados de granularidad en la parcelaci\'on. Sin embargo pareciera haber
un problema formal en \'el, ya que no queda claro si el criterio que utilizan para
medir distancias entre clusters y la forma de representar la uni\'on de los mismos
son compatibles.  \\

El objetivo de este trabajo es analizar los m\'etodos de clustering jer\'arquico
actuales para parcelar toda la corteza y proponer un nuevo enfoque. Utilizamos
la base de datos provista por Human Connectome Project, \'esta posee la dMRI de
varios sujetos organizada por sexo y edad, con la ventaja de que todos los datos
est\'an ya preprocesados. Comenzamos analizando distintos algoritmos de
tractograf\'ia, dada la naturaleza estoc\'astica de los mismos es importante
comprobar si el resultado se estabiliza al utilizar un n\'umero suficientemente
grande de semillas. Tambi\'en es importante determinar si algoritmos diferentes
convergen a una misma soluci\'on. En particular mostramos que para dos
implementaciones distintas, ambas basadas en la librer\'ia \textit{dipy}, los
tractogramas convergen, y lo hacen a resultados similares. Luego comparamos distintos 
m\'etodos para posicionar las semillas dentro de la materia blanca a cierta 
distancia de la corteza cerebral. Concluimos que el mejor m\'etodo se basa en 
utilizar una implementaci\'on de \textit{Fast Marching Method} para generar un
mapa de distancias con signo de cada voxel a la materia gris, respetando la estructura
de la materia blanca. Las posiciones son entonces seleccionadas partiendo desde
cada punto de la corteza y caminando por el gradiente del mapa de distancias una
determinada distancia. Esto nos permite a su vez poder guardar un mapeo directo
desde las semillas hasta la corteza cerebral. Una vez que tenemos las semillas
procedemos a generar los tractogramas, para ello paralelizamos los experimentos
Monte Carlo, corriendo cada uno en un nodo distinto de un cluster. Cada tractograma 
es almacenado por su cuenta, pero al mismo tiempo se guarda una matriz de 
dimensiones $NxM$, siendo $N$ el n\'umero de tractogramas y $M$ la longitud 
de los mismos al transformarlos a una sola dimensi\'on. Mostramos que la mejor
forma de almacenar los mismos es utilizando matrices ralas. Finalmente analizamos
el m\'etodo de clustering descrito por Moreno-Dominguez y presentamos una mejora 
utilizando una transformaci\'on entre el espacio de los tractogramas
y un espacio vectorial donde es posible utilizar la m\'etrica euclidiana. 
Mostramos que nuestro m\'etodo permite salvar los problemas formales que el
anterior presenta. Durante este \'ultimo paso tambi\'en presentamos una 
implementaci\'on propia del algoritmo \textit{Agglomerative Hierarchical
Clustering} que aprovecha fuertemente las propiedades de las matrices ralas tanto
en el espacio de los tractogramas como en el espacio de la transformaci\'on, 
optimizando as\'i el costo temporal y espacial.
