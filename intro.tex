\chapter{Introducci\'on}

En la neurociencia moderna existe la teor\'ia de que el cerebro
puede ser dividido en \'areas de acuerdo a distintos criterios estructurales,
siendo la citoarquitectura de Broadmann \cite{Brodmann1909} una de la m\'as conocidas.
Actualmente existe evidencia de que es posible atribuir un criterio funcional
a cada una de estas regiones, como mover la mano o procesar el lenguaje
\cite{Greicius2003}. No obstante, el c\'omo se relacionan dichas \'areas con funciones
complejas sigue siendo un problema abierto \cite{Barch2013}. As\'i mismo, tampoco
se conoce si esta divisi\'on es \'unica, y en tal caso, qu\'e l\'imites definen
a cada \'area. La relaci\'on funci\'on-estructura posee diversas aplicaciones en la
medicina, como por ejemplo el planeamiento quir\'urgico \cite{Stufflebeam2011}
\cite{Oishi2010}; asistencia durante la cirug\'ia \cite{DeSchotten2005} y rehabilitaci\'on
\cite{Song2014} de pacientes. Por ello existe la necesidad de entender c\'omo es
que el cerebro est\'a conectado estructuralmente, esto es, entender qu\'e regiones
est\'an conectadas f\'isicamente por axones y cu\'anto influye esto en el aspecto
funcional del cerebro. \\

El cerebro puede dividirse en varios tipos de tejido, nosotros nos enfocaremos en
dos de ellos: materia blanca y materia gris. La corteza est\'a formada por 
materia gris, la cual es densa en neuronas. Estas neuronas est\'an conectadas 
entre si mediante axones. Se denomina materia blanca al tejido donde la 
proporci\'on de axones es superior a la de neuronas \cite{Dale2008}. La reciente
invenci\'on de la Resonancia Magn\'etica de Difusi\'on (dMRI) permiti\'o
desarrollar nuevas t\'ecnicas para estudiar la conectividad estructural \cite{Taylor1985}. 
En particular, el conocer la intensidad de difusi\'on que existe en cada punto del 
cerebro permite caracterizar los axones dentro de la materia blanca \cite{Hagmann2006}.
Una forma de hacerlo es utilizando algoritmos de tractograf\'ia \cite{Descoteaux2009}
\cite{Jbabdi2007}, estos toman un punto del cerebro como semilla y devuelven un
tractograma. Un tractograma es una imagen donde cada voxel representa la
probabilidad de que ese punto del cerebro est\'e conectado a la semilla elegida
mediante un conjunto de axones. Las probabilidades se estiman mediante un 
procedimiento Monte Carlo, simulando el recorrido de un n\'umero de part\'iculas
de agua por la materia blanca comenzando desde dicha semilla. Distintos grupos
han propuesto el agrupar estas semillas empleando un algoritmo de \textit{clustering}
para definir nuevos criterios de parcelamiento de la corteza cerebral. \\

\vspace{0.3cm}

Los algoritmos de \textit{clustering} son una herramienta de an\'alisis en campos
como \textit{Machine Learning} y \textit{Data Mining}. Permiten agrupar objetos
en base a alg\'un criterio de similitud. Ejemplos de ellos son: 

\begin{itemize}
    \item K-means: Divide $n$ vectores en $k$ clusters diferentes, siendo $k$
                   un n\'umero predefinido. Cada cluster est\'a formado 
                   por los elementos que m\'as cerca est\'an al vector medio del
                   mismo. \cite{Hartigan1979}
    \item Agglomerative Hierarchical Clustering: Cada observaci\'on comienza en 
                   un cluster distinto. Luego, el algoritmo selecciona iterativamente
                   dos clusters siguiendo alg\'un criterio de similitud, los agrupa
                   en un nuevo cluster y crea un elemento representativo de este.
                   La jerarqu\'ia resultante de agrupar todos los clusters
                   es expresada como un dendrograma. \cite{Mining2009}
    \item Gaussian Mixture: Asume que todas las observaciones provienen de un 
                   n\'umero finito de distribuciones Gaussianas con par\'ametros
                   desconocidos. Implementa \textit{expectation-maximization} para
                   determinar dichos par\'ametros iterativamente. \cite{Mining2009}
\end{itemize}

Cada algoritmo utiliza distintos modelos de cluster, por lo que el espacio de
aplicaci\'on y el resultado var\'ia significativamente de uno a otro. \\

Como ya fue dicho, una forma de parcelar la corteza cerebral es haciendo un 
\textit{clustering} de semillas.  El primer paso para poder hacer esto es seleccionar
la posici\'on de las mismas. Dado que la materia blanca est\'a compuesta
principalmente por axones, es en ella donde se sit\'uan las semillas. Seleccionar
los voxels que ser\'an semilla requiere contar con alguna manera de discriminar
entre materia blanca y materia gris en la imagen. A su vez, si queremos que las
semillas est\'en a cierta distancia de la corteza, se debe tener cuidado en
respetar la forma del cerebro. En la literatura actual se utilizan hasta veinte
mil semillas por hemisferio \cite{Moreno-Dominguez2014} y cien mil part\'iculas 
por semilla \cite{Anwander2006} para generar los tractogramas. Realizar cada
tractograma en paralelo reduce el tiempo total del procesamiento del cerebro. Al
momento de representarlos es importante seleccionar la estructura correcta. Una 
matriz del tama\~no de la imagen de dMRI es la implementaci\'on m\'as sencilla, 
pero como explicaremos en la secci\'on X, solo el 30\% de los valores ser\'an no
nulos. Luego, para agrupar los tractogramas se debe seleccionar un modelo de datos
para representar los datos; un algoritmo de \textit{clustering} y una medida de
similaridad. Finalmente, una vez obtenidos los clusters, es necesario mapear cada
semilla con su respectivo voxel en la corteza cerebral. En resumen, primero hay 
que situar las semillas en la materia blanca; luego se deben generar los 
tractogramas de estas y finalmente hay que aplicar el algoritmo de \textit{clustering}. 
Todos estos pasos son caros en t\'erminos computacionales. \\

Dada la cantidad de opciones a tener en cuenta, distintos grupos han aplicado
diferentes criterios de \textit{clustering} para parcelar la corteza. Por ejemplo,
Behrens et. al \cite{Behrens2003} utilizan \textit{Target-Based Clustering}, este
algoritmo define como restricci\'on que cada \'area solo puede estar conectada con
alguna otra perteneciente a un conjunto predefinido. Anwander et. al \cite{Anwander2006} 
parcelan el \'Area de Broca utilizando \textit{k-means}, para lo cual se necesita
definir un n\'umero de parcelas a encontrar. Moreno-Dominguez et al. 
\cite{Moreno-Dominguez2014} sit\'uan semillas en la interfaz entre materia blanca
y materia gris, a partir de las cuales se crean tractogramas. Dichos tractogramas
son luego agrupados utilizando el algoritmo \textit{Agglomerative Hierarchical
Clustering} con la distancia coseno como medida de similitud, y un centroide como
representante de cada Cluster. La gran ventaja de este \'ultimo caso es que la
parcelaci\'on resultante no posee restricciones respecto al n\'umero de parcelas
a generar, o sobre como las mismas deber\'ian estar conectadas. Por el contrario,
dependiendo la forma en que se desee cortar el dendrograma se obtendr\'an
distintos grados de granularidad en la parcelaci\'on. Sin embargo, no queda claro
que el criterio utilizado para medir distancias entre clusters y la forma de
representar la uni\'on de los mismos sean compatibles. Entonces, si bien el
m\'etodo de Moreno-Dominguez no asume cuantas o como son las \'areas a encontrar,
a\'un no posee el suficiente formalismo. Por esto es importante seguir investigando
nuevos modelos.  \\

El objetivo de este trabajo es analizar los m\'etodos de \textit{clustering} 
jer\'arquico actuales para parcelar toda la corteza y proponer un nuevo enfoque. 
Utilizamos la base de datos provista por \textit{Human Connectome Project} 
\cite{VanEssen2012}, \'esta posee la dMRI de varios sujetos organizada por sexo 
y edad, con la ventaja de que todos los datos est\'an ya preprocesados. Esto nos
permite enfocarnos en el problema del \textit{clustering}, a la vez que permite
reproducir con mayor facilidad nuestro estudio. \\

Una contribuci\'on menor de nuestro trabajo es el an\'alisis de dos 
implementaciones existentes de algoritmos de tractograf\'ia. Dada la naturaleza
estoc\'astica de los mismos es importante comprobar si el resultado se estabiliza
al utilizar un n\'umero suficientemente grande de semillas. Tambi\'en es importante
determinar si algoritmos diferentes convergen a una misma soluci\'on.
En particular mostramos que para dos implementaciones distintas, ambas basadas 
en la librer\'ia \textit{dipy}, los tractogramas convergen. Mas a\'un, lo hacen
a resultados similares. \\

La contribuci\'on principal de este estudio es el realizar un an\'alisis
te\'orico del estado del arte; mostrar las problem\'aticas que presenta y proponer
una nueva forma de parcelar la corteza mediante el \textit{clustering} de semillas.
Nuestro m\'etodo consiste en transformar los tractogramas a un espacio vectorial
y luego agruparlos con \textit{Agglomerative Hierarchical Clustering}. Utilizamos
la m\'etrica euclidiana como medida de similitud y el centroide como \textit{linkage}.
Presentamos una implementaci\'on eficiente de nuestro m\'etodo. Tambi\'en el 
como adaptarlo al uso de matrices ralas para optimizar el costo espacial.
Nuestro m\'etodo produce parcelaciones similares a las obtenidas usando el estado
del arte. La ventaja de nuestro algoritmo es que reduce significativamente el
orden de complejidad temporal y espacial. \\

\begin{comment}
\section{Experimentos para Demian, eliminar luego}

\subsection{Estabilidad Tractogramas}
\textbf{Objetivo}: Probar que el algoritmo para generar los tractogramas converge.\\
\textbf{M\'etodo}: Estudiar la media y varianza utilizando bootstrap. \\
\textbf{Resultado}: El algoritmo que usamos converge, por lo tanto tiene sentido
                    usarlo.\\
\textbf{Secci\'on}: Resultados.\\
                    
\subsection{Posicionar semillas}
\textbf{Objetivo}:  Posicionar semillas a una distancia
                    dada del cortex, respetando la morfolog\'ia del cerebro. \\
\textbf{M\'etodo}:  Presentamos un m\'etodo y lo mejoraramos iterativamente. \\
\textbf{Resultado}: Conseguimos un algoritmo que cumple lo requerido y simplifica
                    el mapeo final entre semillas y cortex.\\
\textbf{Secci\'on}: Resultados.\\

\subsection{Matrices Ralas}
\textbf{Objetivo}:  Almacenar todos los tractogramas en una misma matriz. Esta 
                    matriz debe poder mantenerse en memoria durante el clustering.\\
\textbf{M\'etodo}:  Utilizar matrices ralas. \\
\textbf{Resultado}: Efectivamente, la matriz ahora entra en memoria y permite 
                    realizar operaciones aritm\'eticas de manera eficiente.\\
\textbf{Secci\'on}: M\'etodos.\\                    

\subsection{Broca; Moreno-Dominguez}
\textbf{Objetivo}:  Parcelar el \'Area de Broca.\\
\textbf{M\'etodo}:  Usar Agglomerative Herarchical Clustering con similaridad
                    coseno y linkage centroid. \\
\textbf{Resultado}: Con un n\'umero alto de preprocesamiento el resultado parece
                    tener sentido.\\
\textbf{Secci\'on}: Resultados.\\                    
                    
\subsection{Logit}
\textbf{Objetivo}:  Mostrar el problema de Moreno-Dominguez y presentar Logit
                    + centroide.\\
\textbf{M\'etodo}:  Presentar casos sencillos donde la similaridad coseno no
                    se comporta de manera correcta respecto al linkage centroid. \\
\textbf{Resultado}: Logit mejora los casos en que los vectores son colineales,
                    sin embargo, tambi\'en posee un contraejemplo para el 
                    problema de metrica-linkage.\\
\textbf{Secci\'on}: M\'etodos.\\                                        
                    
\subsection{Broca; Nuestro M\'etodo}
\textbf{Objetivo}:  Parcelar el \'Area de Broca.\\
\textbf{M\'etodo}:  Presentar resultados y compararlos con Moreno-Dominguez. \\
\textbf{Resultado}: Nuestro m\'etodo es un orden de complejidad menor. Pero 
                    parece ser susceptible a ruido, usando un threshold de 0.25
                    da b\'asicamente los mismos resultados que Moreno. 
                    Si se normalizan los vectores el resultado tiene tan poco 
                    sentido que siquiera lo agregu\'e. \\
\textbf{Secci\'on}: Resultados.\\                    
                    
\subsection{Parcelar Corteza}
\textbf{Objetivo}:  Parcelar la corteza.\\
\textbf{M\'etodo}:  Comparar nuestro m\'etodo y el de Moreno-Dominguez \\
\textbf{Resultado}: Moreno-Dominguez est\'a tardando demasiado, actualmente un 
                    trabajo de 96hs est\'a corriendo.\\
\textbf{Secci\'on}: Resultados.\\                                        

\end{comment}
